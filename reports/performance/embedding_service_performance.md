# Embeddings Service Performance Test Report

## Key Findings

- **Image dimension impact**: 4096x4096 images take 4.8x longer than 100x100 images (198.8 ms vs 41.1 ms)
- **File size impact**: 4906 KB files take 11.0x longer than 11 KB files
- **Sequential throughput**: 70.5 req/s
- **Best concurrent throughput**: 71.9 req/s (concurrent_16)


## Test Configuration

| Parameter | Value |
|-----------|-------|
| Iterations per test | 30 |
| Model | DINOv2 (facebook/dinov2-base) |
| Input size | 518x518 (model native) |

## Image Dimension Tests

Measures preprocessing overhead for different input sizes. All images are resized to 518x518 before model inference.

| Dimensions | File Size | Mean | Std | P50 | P95 | P99 |
|------------|-----------|------|-----|-----|-----|-----|
| 100x100 | 9 KB | 41.1 ms | 161.5 ms | 11.1 ms | 11.6 ms | 650.2 ms |
| 512x512 | 194 KB | 13.9 ms | 0.2 ms | 13.9 ms | 14.4 ms | 14.4 ms |
| 1024x1024 | 774 KB | 23.0 ms | 1.2 ms | 22.7 ms | 24.9 ms | 27.3 ms |
| 2048x2048 | 3096 KB | 57.5 ms | 2.6 ms | 57.1 ms | 60.4 ms | 67.7 ms |
| 4096x4096 | 12383 KB | 198.8 ms | 5.7 ms | 198.3 ms | 207.8 ms | 210.0 ms |

**Analysis:**

- Resizing from 4096x4096 to 518x518 adds ~157.7 ms overhead
- Latency variance is notable (avg std: 34.2 ms)


## File Size Tests

Measures impact of JPEG file complexity on processing time. Uses noise images to control compressed size.

| Target | Actual | Mean | Std | P50 | P95 | P99 |
|--------|--------|------|-----|-----|-----|-----|
| 10 KB | 11 KB | 11.4 ms | 0.3 ms | 11.3 ms | 11.8 ms | 12.3 ms |
| 50 KB | 50 KB | 12.1 ms | 0.3 ms | 12.2 ms | 12.4 ms | 12.5 ms |
| 100 KB | 100 KB | 13.3 ms | 0.2 ms | 13.3 ms | 13.6 ms | 13.7 ms |
| 500 KB | 493 KB | 22.7 ms | 0.7 ms | 22.5 ms | 23.8 ms | 24.9 ms |
| 1000 KB | 982 KB | 33.7 ms | 0.5 ms | 33.6 ms | 34.6 ms | 34.9 ms |
| 2000 KB | 1964 KB | 56.9 ms | 2.4 ms | 56.4 ms | 57.7 ms | 66.2 ms |
| 5000 KB | 4906 KB | 124.8 ms | 2.8 ms | 124.0 ms | 131.0 ms | 133.4 ms |

**Analysis:**

- File size has **minimal impact** on latency (decoding is not the bottleneck)


## Throughput Tests

Measures sustained request handling capacity.

| Test | Requests | Duration | Throughput | Mean | P99 |
|------|----------|----------|------------|------|-----|
| sequential | 250 | 3.55 s | **70.5 req/s** | 14.2 ms | 16.3 ms |
| concurrent_2 | 250 | 3.53 s | **70.9 req/s** | 28.1 ms | 43.0 ms |
| concurrent_4 | 248 | 3.47 s | **71.4 req/s** | 55.6 ms | 70.4 ms |
| concurrent_8 | 248 | 3.47 s | **71.5 req/s** | 110.3 ms | 166.9 ms |
| concurrent_16 | 240 | 3.34 s | **71.9 req/s** | 215.5 ms | 313.1 ms |

**Analysis:**

- Sequential baseline: 70.5 req/s
- concurrent_2: no significant speedup (likely CPU-bound)
- concurrent_4: no significant speedup (likely CPU-bound)
- concurrent_8: no significant speedup (likely CPU-bound)
- concurrent_16: no significant speedup (likely CPU-bound)


---

*Report generated by embeddings service performance tests.*