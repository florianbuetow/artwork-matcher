# Gateway Service Performance Test Report

## Key Findings

- **Image dimension impact**: 2000x2000 images (2952 KB) take 18.1x longer than 100x100 images (9 KB)
- **Identify endpoint latency**: 0.8 ms (gateway overhead only)
- **Health check latency**: 0.6 ms
- **Info endpoint latency**: 0.9 ms
- **Sequential throughput**: 1287.3 req/s
- **Best concurrent throughput**: 1280.4 req/s (concurrent_8)
- **Geometric service**: Could not test with geometric service: Service not running


## Test Configuration

| Parameter | Value |
|-----------|-------|
| Iterations per test | 30 |
| Throughput requests | 250 |
| Backend services | Mocked (instant response) |
| Concurrency levels | 2, 4, 8, 16 workers |

**Note:** These tests measure **gateway overhead only**. Backend services (embeddings, search, geometric) are mocked to return instant responses. Real-world latency will be higher depending on backend performance.

## Image Dimension Tests

Measures gateway overhead when processing different image payload sizes. The gateway validates and forwards images but does not decode pixels.

| Dimensions | File Size | Mean | Std | P50 | P95 | P99 |
|------------|-----------|------|-----|-----|-----|-----|
| 100x100 | 9 KB | 1.0 ms | 0.3 ms | 0.9 ms | 1.2 ms | 2.6 ms |
| 250x250 | 48 KB | 1.3 ms | 0.3 ms | 1.2 ms | 1.8 ms | 2.7 ms |
| 500x500 | 189 KB | 2.0 ms | 0.2 ms | 2.0 ms | 2.3 ms | 2.3 ms |
| 750x750 | 418 KB | 3.1 ms | 0.2 ms | 3.1 ms | 3.4 ms | 3.7 ms |
| 1000x1000 | 741 KB | 5.2 ms | 0.4 ms | 5.2 ms | 5.8 ms | 6.0 ms |
| 1500x1500 | 1670 KB | 10.7 ms | 0.6 ms | 10.4 ms | 11.9 ms | 11.9 ms |
| 2000x2000 | 2952 KB | 17.7 ms | 0.9 ms | 17.7 ms | 19.5 ms | 19.9 ms |

**Analysis:**

- Latency increases with image size: 339x larger â†’ 18.1x slower
- Latency is **consistent** across image sizes


## Endpoint Latency Tests

Measures latency for each gateway endpoint.

| Endpoint | Mean | Std | P50 | P95 | P99 |
|----------|------|-----|-----|-----|-----|
| objects_by_id | 0.2 ms | 0.0 ms | 0.2 ms | 0.2 ms | 0.4 ms |
| objects | 0.2 ms | 0.1 ms | 0.2 ms | 0.2 ms | 0.7 ms |
| health | 0.6 ms | 0.3 ms | 0.5 ms | 0.8 ms | 1.9 ms |
| identify | 0.8 ms | 0.1 ms | 0.8 ms | 1.1 ms | 1.1 ms |
| info | 0.9 ms | 0.3 ms | 0.8 ms | 1.7 ms | 2.0 ms |

**Analysis:**

- Simple endpoints (health, info, objects): ~0.5 ms average
- Pipeline endpoint (identify): ~0.8 ms (includes backend coordination)
- **health**: P99 is 3.3x mean - investigate outliers
- **objects**: P99 is 3.1x mean - investigate outliers


## Geometric Service Status

**Could not test with geometric service: Service not running**

Geometric verification performance tests were skipped.


## Throughput Tests

Measures sustained request handling capacity under different concurrency levels.

| Test | Requests | Duration | Throughput | Mean Latency | P99 Latency |
|------|----------|----------|------------|--------------|-------------|
| sequential | 250 | 0.19 s | **1287.3 req/s** | 0.8 ms | 1.1 ms |
| concurrent_2 | 250 | 0.21 s | **1182.5 req/s** | 1.7 ms | 2.9 ms |
| concurrent_4 | 248 | 0.20 s | **1262.1 req/s** | 3.1 ms | 5.5 ms |
| concurrent_8 | 248 | 0.19 s | **1280.4 req/s** | 6.1 ms | 10.6 ms |
| concurrent_16 | 240 | 0.19 s | **1251.4 req/s** | 11.7 ms | 21.7 ms |

**Analysis:**

- Sequential baseline: 1287.3 req/s
- concurrent_2: no significant speedup (mocked backends)
- concurrent_4: no significant speedup (mocked backends)
- concurrent_8: no significant speedup (mocked backends)
- concurrent_16: no significant speedup (mocked backends)
- Throughput is relatively stable across concurrency levels


---

*Report generated by gateway service performance tests.*